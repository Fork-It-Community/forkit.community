---
import { Image } from "astro:assets";
import SpeakerPlaceholder from "@/assets/images/speaker-placeholder.jpeg";
import type { CollectionEntry } from "astro:content";
import { SOCIALS_TYPE_MAP } from "@/content/socials";

interface Props {
  speaker: CollectionEntry<"people">;
}

const { speaker } = Astro.props;
---

<div class="flex h-fit w-fit flex-col items-start gap-2">
  <div class="aspect-square overflow-hidden rounded-lg">
    <Image
      src={speaker.data.avatar ?? SpeakerPlaceholder}
      alt={speaker.data.name}
      width={160}
      height={160}
    />
  </div>
  <div class="flex flex-col gap-2">
    <div class="flex flex-col gap-0.5">
      <p class="line-clamp-3 font-heading text-sm font-medium tracking-wide">
        {speaker.data.name}
      </p>
      {
        !!speaker.data.job && (
          <p class="line-clamp-3 text-xs tracking-wide opacity-60">
            {speaker.data.job}
          </p>
        )
      }
    </div>
    {
      !!speaker.data.company && (
        <>
          {!!speaker.data.company.href ? (
            <a
              href={speaker.data.company.href}
              target="_blank"
              class="text-xs underline opacity-60 transition hover:text-primary hover:opacity-100"
            >
              {speaker.data.company.title}
            </a>
          ) : (
            <p class="text-xs opacity-60">{speaker.data.company.title}</p>
          )}
        </>
      )
    }
    {
      !!speaker.data.socials && (
        <ul class="flex gap-x-2">
          {speaker.data.socials.map((social) => {
            const Icon = SOCIALS_TYPE_MAP[social.type];

            return (
              <Fragment>
                <li>
                  <a
                    href={social.href}
                    class="opacity-60 transition hover:text-primary hover:opacity-100"
                    target="_blank"
                  >
                    <span class="sr-only">{social.type}</span>
                    <Icon />
                  </a>
                </li>
              </Fragment>
            );
          })}
        </ul>
      )
    }
  </div>
</div>
